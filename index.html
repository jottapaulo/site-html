<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Paran√° Pe√ßas Toledo</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Exo+2:wght@700&display=swap" rel="stylesheet">
  <style>
    :root {
      --orange: #ff9800;
      --bg: #0a0a0a;
      --card: #181818;
      --text: #eaeaea;
      --muted: #888888;
    }

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background-color: var(--bg);
      color: var(--text);
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 15px 40px;
      background: var(--card);
      box-shadow: 0 2px 8px rgba(0,0,0,0.8);
      font-family: 'Exo 2', sans-serif;
    }

    .brand {
      font-size: 20px;
      font-weight: 700;
      color: var(--orange);
    }

    .social-links {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .brand-link {
      display: flex;
      align-items: center;
      font-family: 'Exo 2', sans-serif;
      font-size: 18px;
      font-weight: 700;
      color: var(--orange);
      text-decoration: none;
    }
    .brand-link:hover { text-decoration: underline; }

    .social-icon { width: 24px; height: 24px; margin-right: 6px; }

    main {
      text-align: center;
      padding: 100px 20px 60px;
    }

    main h1 {
      font-family: 'Exo 2', sans-serif;
      color: var(--orange);
      font-size: 50px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    main p { color: var(--muted); font-size: 18px; }

    .upload-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border: 2px dashed var(--orange);
      border-radius: 12px;
      padding: 40px;
      margin: 30px auto;
      max-width: 500px;
      cursor: pointer;
      background: var(--card);
      transition: all 0.3s ease;
      position: relative;
    }
    .upload-area:hover { background: #252525; border-color: #ff7700; }

    .btn {
      background: var(--orange);
      color: #fff;
      border: none;
      padding: 12px 22px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      margin: 10px 5px;
      transition: 0.3s;
    }
    .btn:hover { background: #e67e00; }
    .btn-clear { background: #d32f2f; }
    .btn-clear:hover { background: #a60000; }

    .sub-text { color: var(--muted); font-size: 14px; margin-top: 10px; }

    .preview { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin-top: 20px; }
    .preview img { max-width: 120px; max-height: 120px; object-fit: cover; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }

    .results { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; margin: 40px 0; }
    .result-item { display: flex; flex-direction: column; align-items: center; gap: 10px; }
    .result-item img { max-width: 180px; max-height: 180px; object-fit: contain; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
    .download-btn { background: var(--orange); color: #fff; padding: 10px 18px; border-radius: 6px; font-weight: 600; cursor: pointer; border: none; }
    .download-btn:hover { background: #e67e00; }

    .action-buttons { display: flex; justify-content: center; gap: 10px; margin-top: 15px; }

    /* Loader circular compacto e suave */
    #loaderContainer {
      display: none;
      position: relative;
      width: 60px;
      height: 60px;
      margin: 20px auto;
    }
    #loaderCircle {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 6px solid #333;
      border-top: 6px solid var(--orange);
      animation: spin 1.2s linear infinite;
    }
    #loaderText {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-weight: 700;
      color: #fff;
      font-size: 16px;
      font-family: 'Inter', sans-serif;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    footer { background: var(--card); text-align: center; padding: 20px; margin-top: 40px; color: var(--muted); border-top: 1px solid #222; }
    footer a { color: var(--orange); text-decoration: none; }
    footer a:hover { text-decoration: underline; }
  </style>
</head>
<body>

<header>
  <div class="brand">PARAN√Å PE√áAS TOLEDO</div>
  <div class="social-links">
    <a href="https://www.paranapecastoledo.com.br" target="_blank" class="brand-link">
      <img src="pictures/logo.png" alt="Site Oficial" class="social-icon"> SITE OFICIAL
    </a>
    <a href="https://www.mercadolivre.com.br/pagina/paranapeastoledo" target="_blank" class="brand-link">
      <img src="pictures/logo_mercadoLivre.png" alt="Mercado Livre" class="social-icon"> MERCADO LIVRE
    </a>
    <a href="https://www.instagram.com/pr_pecas/" target="_blank" class="brand-link">
      <img src="pictures/logo_instagram.png" alt="Instagram" class="social-icon"> INSTAGRAM
    </a>
  </div>
</header>

<main>
  <h1>Remover Fundo de Imagens</h1>
  <p>Envie suas fotos e obtenha imagens PNG em segundos.</p>

  <label class="upload-area" id="uploadArea">
    <input type="file" id="inputImagem" multiple hidden>
    <button class="btn">‚ûï Iniciar com foto</button>
    <p class="sub-text">ou solte uma imagem aqui</p>
  </label>

  <div class="preview" id="preview" style="display:none;"></div>

  <div class="action-buttons">
    <button class="btn" id="processarBtn" style="display:none;">PROCESSAR</button>
    <button class="btn btn-clear" id="limparBtn" style="display:none;">üóëÔ∏è</button>
  </div>

  <!-- Loader circular compacto -->
  <div id="loaderContainer">
    <div id="loaderCircle"></div>
    <div id="loaderText">0%</div>
  </div>

  <div class="results" id="results"></div>
  <button class="btn" id="baixarTodasBtn" style="display:none;">Salvar Todas</button>
</main>

<footer>
  <p>&copy; 2025 <a href="#">Paran√° Pe√ßas Toledo</a>. Todos os direitos reservados.</p>
</footer>

<script>
const dropArea = document.getElementById("uploadArea");
const input = document.getElementById("inputImagem");
const preview = document.getElementById("preview");
const processarBtn = document.getElementById("processarBtn");
const limparBtn = document.getElementById("limparBtn");
const results = document.getElementById("results");
const baixarTodasBtn = document.getElementById("baixarTodasBtn");
const loaderContainer = document.getElementById("loaderContainer");
const loaderText = document.getElementById("loaderText");
let processedFiles = [];

// Abrir explorador de arquivos
dropArea.addEventListener("click", () => input.click());

// Pr√©-visualiza√ß√£o de imagens
input.addEventListener("change", () => {
  if (input.files.length > 0) {
    dropArea.style.display = "none";
    preview.style.display = "flex";
    processarBtn.style.display = "inline-block";
    limparBtn.style.display = "inline-block";
  }
  preview.innerHTML = "";
  [...input.files].forEach(file => {
    const reader = new FileReader();
    reader.onload = e => {
      const img = document.createElement("img");
      img.src = e.target.result;
      preview.appendChild(img);
    };
    reader.readAsDataURL(file);
  });
});

// Drag & drop
["dragenter","dragover"].forEach(eventName => {
  dropArea.addEventListener(eventName, e => {
    e.preventDefault();
    dropArea.classList.add("dragover");
  });
});
["dragleave","drop"].forEach(eventName => {
  dropArea.addEventListener(eventName, e => {
    e.preventDefault();
    dropArea.classList.remove("dragover");
  });
});
dropArea.addEventListener("drop", e => {
  e.preventDefault();
  input.files = e.dataTransfer.files;
  input.dispatchEvent(new Event("change"));
});

// Processar imagens
processarBtn.addEventListener("click", async () => {
  if (!input.files.length) return alert("Selecione imagens primeiro!");
  
  loaderContainer.style.display = "block";
  results.innerHTML = "";
  processedFiles = [];

  const files = [...input.files];
  for (let i = 0; i < files.length; i++) {
    const file = files[i];
    const formData = new FormData();
    formData.append("imagens", file);

    try {
       try {
        const response = await fetch("https://removedorbackground.onrender.com/remover-fundo", {
          method: "POST",
          body: formData
        });
      const data = await response.json();
      const imgBase64 = data[0];

      const div = document.createElement("div");
      div.className = "result-item";

      const img = document.createElement("img");
      img.src = "data:image/png;base64," + imgBase64;

      const btn = document.createElement("button");
      btn.textContent = "Salvar";
      btn.className = "download-btn";
      btn.onclick = () => {
        const a = document.createElement("a");
        a.href = img.src;
        a.download = "processada_" + (i+1) + ".png";
        a.click();
      };

      div.appendChild(img);
      div.appendChild(btn);
      results.appendChild(div);
      processedFiles.push(img.src);

      // Atualiza porcentagem do loader
      const percent = Math.round(((i+1) / files.length) * 100);
      loaderText.textContent = percent + "%";

    } catch (err) {
      console.error(err);
      alert("Erro ao processar a imagem " + (i+1));
    }
  }

  loaderContainer.style.display = "none";
  baixarTodasBtn.style.display = "inline-block";
});

// Limpar tudo
limparBtn.addEventListener("click", () => {
  input.value = "";
  preview.innerHTML = "";
  results.innerHTML = "";
  processedFiles = [];
  dropArea.style.display = "flex";
  processarBtn.style.display = "none";
  limparBtn.style.display = "none";
  baixarTodasBtn.style.display = "none";
  loaderContainer.style.display = "none";
  loaderText.textContent = "0%";
});

// Baixar todas
baixarTodasBtn.addEventListener("click", () => {
  processedFiles.forEach((src, idx) => {
    const a = document.createElement("a");
    a.href = src;
    a.download = "processada_" + (idx+1) + ".png";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  });
});
</script>

</body>
</html>
